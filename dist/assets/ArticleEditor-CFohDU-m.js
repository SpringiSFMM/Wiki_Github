import{e as S,b as y,j as e,a as i}from"./index-Cf1eI5hH.js";import{d as q,b as w,R as a,L as A}from"./vendor-CPt1K6Li.js";import{u as L}from"./useMutation-DI0lfsM0.js";import{v as T,N as E,V as n}from"./ui-Rj_xN0Fu.js";import{u as F}from"./auth-JTDanQEO.js";import{T as K}from"./TipTapEditor-TMUcrxQ3.js";function G(){const{id:r}=q(),b=w(),u=S();F();const[o,m]=a.useState(""),[l,p]=a.useState(""),[d,x]=a.useState(""),[g,h]=a.useState("draft"),{data:s,isLoading:j}=y({queryKey:["article",r],queryFn:async()=>r?(await i.get(`/api/admin/articles/${r}`)).data:null,enabled:!!r}),{data:k=[],isLoading:N}=y({queryKey:["categories"],queryFn:async()=>(await i.get("/api/admin/categories")).data});a.useEffect(()=>{s&&(p(s.title),m(s.content),x(s.category),h(s.status))},[s]);const c=L({mutationFn:async t=>r?i.put(`/api/admin/articles/${r}`,t):i.post("/api/admin/articles",t),onSuccess:()=>{u.invalidateQueries({queryKey:["articles"]}),u.invalidateQueries({queryKey:["dashboardStats"]}),n.success(r?"Article updated successfully":"Article created successfully"),b("/admin")},onError:t=>{var f,v;console.error("Save error:",t),n.error(((v=(f=t.response)==null?void 0:f.data)==null?void 0:v.message)||"Failed to save article")}}),C=()=>{if(!l.trim()){n.error("Title is required");return}if(!d){n.error("Category is required");return}if(!o.trim()){n.error("Content is required");return}c.mutate({title:l.trim(),content:o.trim(),category:d,status:g})};return j||N?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex items-center justify-center",children:e.jsx("div",{className:"text-dark-300",children:"Loading..."})}):e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col",children:[e.jsx("div",{className:"bg-dark-900 border-b border-dark-800 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(A,{to:"/admin",className:"text-dark-200 hover:text-neon-400",children:e.jsx(T,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",value:l,onChange:t=>p(t.target.value),placeholder:"Article Title",className:"bg-dark-800 text-dark-100 px-4 py-2 rounded-lg border border-dark-700 focus:outline-none focus:border-neon-500 w-64"}),e.jsxs("select",{value:d,onChange:t=>x(t.target.value),className:"bg-dark-800 text-dark-100 px-4 py-2 rounded-lg border border-dark-700 focus:outline-none focus:border-neon-500",children:[e.jsx("option",{value:"",children:"Select Category"}),k.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]}),e.jsxs("select",{value:g,onChange:t=>h(t.target.value),className:"bg-dark-800 text-dark-100 px-4 py-2 rounded-lg border border-dark-700 focus:outline-none focus:border-neon-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsxs("button",{onClick:C,disabled:c.isPending,className:"px-4 py-2 bg-neon-600 text-dark-950 rounded-lg hover:bg-neon-500 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),c.isPending?"Saving...":"Save"]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(K,{value:o,onChange:m,style:{height:"calc(100vh - 8rem)"},placeholder:"Gib hier deinen Artikelinhalt ein..."})})]})}export{G as ArticleEditor};
