import{e as y,b as N,j as e,a as m}from"./index-Cf1eI5hH.js";import{d as k,b as w,R as d,L as S}from"./vendor-CPt1K6Li.js";import{u as b}from"./useMutation-DI0lfsM0.js";import{v as U,N as C,V as a}from"./ui-Rj_xN0Fu.js";import{u as E}from"./auth-JTDanQEO.js";import{T as q}from"./TipTapEditor-TMUcrxQ3.js";function M(){const{id:s}=k(),p=w(),o=y();E();const[r,x]=d.useState(""),[i,f]=d.useState(""),[u,h]=d.useState("draft"),{data:n,isLoading:g}=N({queryKey:["update",s],queryFn:async()=>s?(await m.get(`/api/admin/updates/${s}`)).data:null,enabled:!!s});d.useEffect(()=>{n&&(f(n.title),x(n.content),h(n.status))},[n]);const l=b({mutationFn:async t=>(await m.post("/api/admin/updates",t)).data,onSuccess:()=>{o.invalidateQueries({queryKey:["admin-updates"]}),a.success("Update created successfully"),p("/admin/updates")},onError:()=>{a.error("Failed to create update")}}),c=b({mutationFn:async t=>(await m.put(`/api/admin/updates/${t.id}`,t)).data,onSuccess:()=>{o.invalidateQueries({queryKey:["admin-updates"]}),o.invalidateQueries({queryKey:["update",s]}),a.success("Update updated successfully"),p("/admin/updates")},onError:()=>{a.error("Failed to update update")}}),j=t=>{if(t.preventDefault(),!i.trim()){a.error("Title is required");return}if(!r.trim()){a.error("Content is required");return}s?c.mutate({id:s,title:i,content:r,status:u}):l.mutate({title:i,content:r,status:u})};return g&&s?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-dark-300",children:"Loading update..."})}):e.jsx("div",{className:"bg-dark-950 text-dark-200 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-neon-400",children:s?"Edit Update":"Create New Update"}),e.jsxs(S,{to:"/admin/updates",className:"flex items-center text-dark-300 hover:text-neon-400",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Back to Updates"]})]}),e.jsx("form",{onSubmit:j,className:"space-y-6",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-dark-300 mb-2",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:i,onChange:t=>f(t.target.value),className:"w-full px-4 py-2 bg-dark-800 border border-dark-700 rounded-md text-dark-200 focus:outline-none focus:ring-2 focus:ring-neon-500 focus:border-transparent",placeholder:"Enter update title"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-dark-300 mb-2",children:"Content"}),e.jsx(q,{value:r,onChange:x,style:{height:"400px",marginBottom:"50px"},placeholder:"Enter your update content here..."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-dark-300 mb-2",children:"Status"}),e.jsxs("select",{id:"status",value:u,onChange:t=>h(t.target.value),className:"w-full px-4 py-2 bg-dark-800 border border-dark-700 rounded-md text-dark-200 focus:outline-none focus:ring-2 focus:ring-neon-500 focus:border-transparent",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",className:"flex items-center bg-neon-500 hover:bg-neon-600 text-dark-950 px-4 py-2 rounded-md transition-colors",disabled:l.isPending||c.isPending,children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),l.isPending||c.isPending?"Saving...":"Save Update"]})})]})})]})})}export{M as UpdateEditor};
