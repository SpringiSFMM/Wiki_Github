import{f as C,e as q,i as w,k as A,R as a,a as y,j as e,L,d as i,V as n}from"./index-D4ivp__p.js";import{u as T}from"./useMutation-D_tbq0G-.js";import{T as E}from"./TipTapEditor-mrJwGKvi.js";import{A as F}from"./arrow-left-7OKkgQLN.js";import{S as K}from"./save-Btslk6Wo.js";function D(){const{id:r}=C(),b=q(),u=w();A();const[o,m]=a.useState(""),[l,x]=a.useState(""),[d,p]=a.useState(""),[g,h]=a.useState("draft"),{data:s,isLoading:j}=y({queryKey:["article",r],queryFn:async()=>r?(await i.get(`/api/admin/articles/${r}`)).data:null,enabled:!!r}),{data:k=[],isLoading:N}=y({queryKey:["categories"],queryFn:async()=>(await i.get("/api/admin/categories")).data});a.useEffect(()=>{s&&(x(s.title),m(s.content),p(s.category),h(s.status))},[s]);const c=T({mutationFn:async t=>r?i.put(`/api/admin/articles/${r}`,t):i.post("/api/admin/articles",t),onSuccess:()=>{u.invalidateQueries({queryKey:["articles"]}),u.invalidateQueries({queryKey:["dashboardStats"]}),n.success(r?"Article updated successfully":"Article created successfully"),b("/admin")},onError:t=>{var f,v;console.error("Save error:",t),n.error(((v=(f=t.response)==null?void 0:f.data)==null?void 0:v.message)||"Failed to save article")}}),S=()=>{if(!l.trim()){n.error("Title is required");return}if(!d){n.error("Category is required");return}if(!o.trim()){n.error("Content is required");return}c.mutate({title:l.trim(),content:o.trim(),category:d,status:g})};return j||N?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex items-center justify-center",children:e.jsx("div",{className:"text-dark-300",children:"Loading..."})}):e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col",children:[e.jsx("div",{className:"bg-dark-900 border-b border-dark-800 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(L,{to:"/admin",className:"text-dark-200 hover:text-neon-400",children:e.jsx(F,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",value:l,onChange:t=>x(t.target.value),placeholder:"Article Title",className:"bg-dark-800 text-dark-100 px-4 py-2 rounded-lg border border-dark-700 focus:outline-none focus:border-neon-500 w-64"}),e.jsxs("select",{value:d,onChange:t=>p(t.target.value),className:"bg-dark-800 text-dark-100 px-4 py-2 rounded-lg border border-dark-700 focus:outline-none focus:border-neon-500",children:[e.jsx("option",{value:"",children:"Select Category"}),k.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]}),e.jsxs("select",{value:g,onChange:t=>h(t.target.value),className:"bg-dark-800 text-dark-100 px-4 py-2 rounded-lg border border-dark-700 focus:outline-none focus:border-neon-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsxs("button",{onClick:S,disabled:c.isPending,className:"px-4 py-2 bg-neon-600 text-dark-950 rounded-lg hover:bg-neon-500 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),c.isPending?"Saving...":"Save"]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(E,{value:o,onChange:m,style:{height:"calc(100vh - 8rem)"},placeholder:"Gib hier deinen Artikelinhalt ein..."})})]})}export{D as ArticleEditor};
